---
title: 'İzlenecek yol: WPF İçeriğini Win32 içinde Barındırma'
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
ms.openlocfilehash: 3433819761c19b616a7c9c19fe52e250b0f028dc
ms.sourcegitcommit: 33c8d6f7342a4bb2c577842b7f075b0e20a2fa40
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 09/12/2019
ms.locfileid: "70929185"
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="3c55d-102">İzlenecek yol: WPF İçeriğini Win32 içinde Barındırma</span><span class="sxs-lookup"><span data-stu-id="3c55d-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="3c55d-103">uygulamalar oluşturmak için zengin bir ortam sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c55d-103">provides a rich environment for creating applications.</span></span> <span data-ttu-id="3c55d-104">Ancak, kod içinde [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] önemli bir yatırımınız olduğunda, özgün kodunuzu yeniden yazmak yerine uygulamanıza işlevsellik eklemek [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] daha etkili olabilir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="3c55d-105">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] bir[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] pencerede içerik barındırmak için basit bir mekanizma sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c55d-105">provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="3c55d-106">Bu öğreticide, bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] pencerede içerik barındıran [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [bir Win32 pencere örneğinde WPF içeriği barındıran](https://go.microsoft.com/fwlink/?LinkID=160004)örnek bir uygulamanın nasıl yazılacağı açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="3c55d-107">Bu örneği, herhangi bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] pencereyi barındırmak için genişletebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="3c55d-108">Yönetilen ve yönetilmeyen kodu karıştırmayı içerdiğinden, uygulama/Clide C++yazılır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-108">Because it involves mixing managed and unmanaged code, the application is written in C++/CLI.</span></span>  

<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="3c55d-109">Gereksinimler</span><span class="sxs-lookup"><span data-stu-id="3c55d-109">Requirements</span></span>  
 <span data-ttu-id="3c55d-110">Bu öğreticide, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] hem hem de programlama ile ilgili temel bir benzerlik varsayılmaktadır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="3c55d-111">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Programlamaya temel bir giriş için [bkz. Başlarken](../getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="3c55d-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../getting-started/index.md).</span></span> <span data-ttu-id="3c55d-112">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Programlamaya giriş için, özellikle Charles Petzold tarafından yapılan belirli bir *programlama* penceresinde, konudaki çok sayıda kitaplardan birine başvurmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="3c55d-113">Bu öğreticiye eşlik eden örnek, C++/CLI ' da uygulandığından, bu öğreticide, Windows API 'sinin programlanması ve yönetilen kod programlamasını anlamak için kullanımı hakkında C++ bilgiler verilir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-113">Because the sample that accompanies this tutorial is implemented in C++/CLI, this tutorial assumes familiarity with the use of C++ to program the Windows API plus an understanding of managed code programming.</span></span> <span data-ttu-id="3c55d-114">/CLI ile C++benzerlik yararlı ancak gerekli değildir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-114">Familiarity with C++/CLI is helpful but not essential.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3c55d-115">Bu öğretici, ilişkili örnekten bir dizi kod örneği içerir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="3c55d-116">Ancak okunabilirlik için, örnek kodu tamamen içermez.</span><span class="sxs-lookup"><span data-stu-id="3c55d-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="3c55d-117">Tüm örnek kod için bkz. [bir Win32 pencere ÖRNEĞINDE WPF Içeriğini barındırma](https://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="3c55d-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="3c55d-118">Temel yordam</span><span class="sxs-lookup"><span data-stu-id="3c55d-118">The Basic Procedure</span></span>  
 <span data-ttu-id="3c55d-119">Bu bölümde, içeriği bir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] pencerede barındırmak için kullandığınız temel yordam özetlenmektedir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="3c55d-120">Kalan bölümlerde her adımın ayrıntıları açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="3c55d-121">İçeriği bir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] pencerede barındırmak için anahtar <xref:System.Windows.Interop.HwndSource> sınıfı olur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="3c55d-122">Bu sınıf, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] pencerede sarmalanmış ve bu da bir alt pencere olarak uygulamanıza [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] dahil olmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c55d-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="3c55d-123">Aşağıdaki yaklaşım, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] ve [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] öğesini tek bir uygulamada birleştirir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1. <span data-ttu-id="3c55d-124">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriğinizi yönetilen bir sınıf olarak uygulayın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2. <span data-ttu-id="3c55d-125">/Cliile C++bir Windows uygulaması uygulayın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-125">Implement a Windows application with C++/CLI.</span></span> <span data-ttu-id="3c55d-126">Var olan bir uygulama ve yönetilmeyen C++ kod ile başlıyorsanız, genellikle proje ayarlarınızı `/clr` derleyici bayrağını içerecek şekilde değiştirerek yönetilen kodu çağırmak için bunu etkinleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-126">If you are starting with an existing application and unmanaged C++ code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3. <span data-ttu-id="3c55d-127">İş parçacığı modelini tek iş parçacıklı Apartment (STA) olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4. <span data-ttu-id="3c55d-128">[WM_CREATE](/windows/desktop/winmsg/wm-create)bildirimini pencere yordamınıza işleyin ve şunları yapın:</span><span class="sxs-lookup"><span data-stu-id="3c55d-128">Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:</span></span>  
  
    1. <span data-ttu-id="3c55d-129">Üst pencereyle `parent` parametresi <xref:System.Windows.Interop.HwndSource> olarak yeni bir nesne oluşturun.</span><span class="sxs-lookup"><span data-stu-id="3c55d-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2. <span data-ttu-id="3c55d-130">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik sınıfınızın bir örneğini oluşturun.</span><span class="sxs-lookup"><span data-stu-id="3c55d-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3. <span data-ttu-id="3c55d-131"><xref:System.Windows.Interop.HwndSource.RootVisual%2A> Özelliğine içeriknesnesine[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] bir başvuru atayın. <xref:System.Windows.Interop.HwndSource></span><span class="sxs-lookup"><span data-stu-id="3c55d-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4. <span data-ttu-id="3c55d-132">İçerik için HWND 'yi alın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-132">Get the HWND for the content.</span></span> <span data-ttu-id="3c55d-133"><xref:System.Windows.Interop.HwndSource> Nesnesinin özelliği, pencere tanıtıcısını (hwnd) içerir. <xref:System.Windows.Interop.HwndSource.Handle%2A></span><span class="sxs-lookup"><span data-stu-id="3c55d-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="3c55d-134">Uygulamanızın yönetilmeyen bölümünde kullanabileceğiniz bir hwnd almak için bir HWND 'ye atayın `Handle.ToPointer()` .</span><span class="sxs-lookup"><span data-stu-id="3c55d-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5. <span data-ttu-id="3c55d-135">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriğiniz için bir başvuru tutmak üzere statik alan içeren bir yönetilen sınıf uygulayın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3c55d-136">Bu sınıf, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kodunuzun içeriğine yönelik bir başvuru almanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c55d-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6. <span data-ttu-id="3c55d-137">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği statik alana atayın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7. <span data-ttu-id="3c55d-138">Bir veya daha fazla [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] olaya bir işleyici ekleyerek içerikten bildirim alın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8. <span data-ttu-id="3c55d-139">Özellikleri ayarlamak için statik alanda depoladığınız başvuruyu kullanarak içerikleiletişimkurunvebuşekildedevamedin.[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3c55d-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3c55d-140">İçeriğinizi uygulamak için de [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]kullanabilirsiniz. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3c55d-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3c55d-141">Bununla birlikte, bir dinamik bağlantı kitaplığı (dll) olarak ayrı olarak derlemek ve [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] uygulamanızdan dll 'ye başvurmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-141">However, you will have to compile it separately as a dynamic-link library (DLL) and reference that DLL from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="3c55d-142">Yordamın geri kalanı yukarıda ana hatlarıyla benzerdir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-142">The remainder of the procedure is similar to that outlined above.</span></span>

<a name="implementing_the_application"></a>
## <a name="implementing-the-host-application"></a><span data-ttu-id="3c55d-143">Konak uygulamasını uygulama</span><span class="sxs-lookup"><span data-stu-id="3c55d-143">Implementing the Host Application</span></span>
 <span data-ttu-id="3c55d-144">Bu bölümde, basit [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] bir uygulamada içeriğin nasıl barındırılacağını açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="3c55d-145">İçerik, bir yönetilen sınıf olarak C++/CLI ' da uygulanır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-145">The content itself is implemented in C++/CLI as a managed class.</span></span> <span data-ttu-id="3c55d-146">Çoğu bölümde, basit [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] bir programlama olur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="3c55d-147">İçerik uygulamasının temel yönleri [WPF Içeriğini uygulama](#implementing_the_wpf_page)bölümünde ele alınmıştır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>

- [<span data-ttu-id="3c55d-148">Temel uygulama</span><span class="sxs-lookup"><span data-stu-id="3c55d-148">The Basic Application</span></span>](#the_basic_application)

- [<span data-ttu-id="3c55d-149">WPF Içeriğini barındırma</span><span class="sxs-lookup"><span data-stu-id="3c55d-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)

- [<span data-ttu-id="3c55d-150">WPF Içeriğine başvuru tutma</span><span class="sxs-lookup"><span data-stu-id="3c55d-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)

- [<span data-ttu-id="3c55d-151">WPF Içeriğiyle iletişim kurma</span><span class="sxs-lookup"><span data-stu-id="3c55d-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)

<a name="the_basic_application"></a>
### <a name="the-basic-application"></a><span data-ttu-id="3c55d-152">Temel uygulama</span><span class="sxs-lookup"><span data-stu-id="3c55d-152">The Basic Application</span></span>
 <span data-ttu-id="3c55d-153">Ana bilgisayar uygulaması için başlangıç noktası, bir Visual Studio 2005 şablonu oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-153">The starting point for the host application was to create a Visual Studio 2005 template.</span></span>

1. <span data-ttu-id="3c55d-154">Visual Studio 2005 ' i açın ve **Dosya** menüsünden **Yeni proje** ' yi seçin.</span><span class="sxs-lookup"><span data-stu-id="3c55d-154">Open Visual Studio 2005, and select **New Project** from the **File** menu.</span></span>

2. <span data-ttu-id="3c55d-155">[!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] Proje türleri listesinden **Win32** öğesini seçin.</span><span class="sxs-lookup"><span data-stu-id="3c55d-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="3c55d-156">Varsayılan diliniz yoksa C++, bu proje türlerini **diğer diller**altında bulacaksınız.</span><span class="sxs-lookup"><span data-stu-id="3c55d-156">If your default language is not C++, you will find these project types under **Other Languages**.</span></span>

3. <span data-ttu-id="3c55d-157">Bir **Win32 Proje** şablonu seçin, projeye bir ad atayın ve **Win32 uygulama sihirbazını**başlatmak için **Tamam** ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>

4. <span data-ttu-id="3c55d-158">Sihirbazın varsayılan ayarlarını kabul edin ve projeyi başlatmak için **son** ' a tıklayın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>

 <span data-ttu-id="3c55d-159">Şablon, aşağıdakiler dahil olmak [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] üzere temel bir uygulama oluşturur:</span><span class="sxs-lookup"><span data-stu-id="3c55d-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>

- <span data-ttu-id="3c55d-160">Uygulama için bir giriş noktası.</span><span class="sxs-lookup"><span data-stu-id="3c55d-160">An entry point for the application.</span></span>

- <span data-ttu-id="3c55d-161">İlişkili bir pencere yordamıyla (WndProc) bir pencere.</span><span class="sxs-lookup"><span data-stu-id="3c55d-161">A window, with an associated window procedure (WndProc).</span></span>

- <span data-ttu-id="3c55d-162">**Dosya** ve **Yardım** başlıkları içeren bir menü.</span><span class="sxs-lookup"><span data-stu-id="3c55d-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="3c55d-163">**Dosya** menüsünde, uygulamayı kapatan bir **Çıkış** öğesi vardır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="3c55d-164">**Yardım** menüsünde basit bir iletişim kutusu başlatan **hakkında** bir öğe bulunur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>

 <span data-ttu-id="3c55d-165">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği barındırmak için kod yazmaya başlamadan önce, temel şablonda iki değişiklik yapmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>

 <span data-ttu-id="3c55d-166">Birincisi, projeyi yönetilen kod olarak derlemek olur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="3c55d-167">Varsayılan olarak, proje yönetilmeyen kod olarak derlenir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="3c55d-168">Ancak, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] yönetilen kodda uygulandığından, projenin buna göre derlenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>

1. <span data-ttu-id="3c55d-169">**Çözüm Gezgini** ' de proje adına sağ tıklayın ve bağlam menüsünden **Özellikler** ' i seçerek **Özellik sayfaları** iletişim kutusunu başlatın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>

2. <span data-ttu-id="3c55d-170">Sol bölmedeki ağaç görünümünden **yapılandırma özellikleri** ' ni seçin.</span><span class="sxs-lookup"><span data-stu-id="3c55d-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>

3. <span data-ttu-id="3c55d-171">Sağ bölmedeki **Proje Varsayılanları** listesinden **ortak dil çalışma zamanı** desteği ' ni seçin.</span><span class="sxs-lookup"><span data-stu-id="3c55d-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>

4. <span data-ttu-id="3c55d-172">Açılan liste kutusundan **ortak dil çalışma zamanı desteği (/CLR)** öğesini seçin.</span><span class="sxs-lookup"><span data-stu-id="3c55d-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>

> [!NOTE]
> <span data-ttu-id="3c55d-173">Bu derleyici bayrağı uygulamanızda yönetilen kod kullanmanıza izin verir, ancak yönetilmeyen kodunuz daha önce olduğu gibi derlenmeye devam eder.</span><span class="sxs-lookup"><span data-stu-id="3c55d-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>

 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="3c55d-174">tek iş parçacıklı Apartment (STA) iş parçacığı modelini kullanır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-174">uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="3c55d-175">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik kodu ile düzgün bir şekilde çalışabilmek için, giriş noktasına bir öznitelik uygulayarak uygulamanın iş parçacığı modelini STA olarak ayarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>

 [!code-cpp[Win32HostingWPFPage#WinMain](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]

<a name="hosting_the_wpf_page"></a>
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="3c55d-176">WPF Içeriğini barındırma</span><span class="sxs-lookup"><span data-stu-id="3c55d-176">Hosting the WPF Content</span></span>
 <span data-ttu-id="3c55d-177">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik, basit bir adres girişi uygulamasıdır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="3c55d-178">Kullanıcı adı, adres <xref:System.Windows.Controls.TextBox> vb. almak için çeşitli denetimlerden oluşur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="3c55d-179">Ayrıca, **Tamam** ve <xref:System.Windows.Controls.Button> **iptal**' de iki denetim vardır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="3c55d-180">Kullanıcı **Tamam**' ı tıklattığında, düğmenin <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olay işleyicisi <xref:System.Windows.Controls.TextBox> denetimlerden verileri toplar, bunları karşılık gelen özelliklere atar ve özel bir olay `OnButtonClicked`oluşturur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="3c55d-181">Kullanıcı **iptal**' i tıklattığında işleyici yalnızca yükseltilir `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="3c55d-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="3c55d-182">İçin `OnButtonClicked` olay bağımsız değişkeni nesnesi, hangi düğmenin tıklandığını gösteren bir Boole alanı içerir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>

 <span data-ttu-id="3c55d-183">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği barındıracak kod, ana bilgisayar penceresinde [WM_CREATE](/windows/desktop/winmsg/wm-create) bildirimi için bir işleyicide uygulanır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCreate](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]

 <span data-ttu-id="3c55d-184">Yöntemi `GetHwnd` , boyut ve konum bilgilerini ve üst pencere tanıtıcısını alır ve barındırılan [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğin pencere tanıtıcısını döndürür.</span><span class="sxs-lookup"><span data-stu-id="3c55d-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

> [!NOTE]
> <span data-ttu-id="3c55d-185">Ad`System::Windows::Interop` alanı için bir `#using` yönerge kullanamazsınız.</span><span class="sxs-lookup"><span data-stu-id="3c55d-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="3c55d-186">Bunun yapılması, <xref:System.Windows.Interop.MSG> bu ad alanındaki yapı ve Winuser. h içinde belirtilen MSG yapısı arasında bir ad çakışması oluşturur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="3c55d-187">Bunun yerine, bu ad alanının içeriğine erişmek için tam nitelikli adlar kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>

 [!code-cpp[Win32HostingWPFPage#GetHwnd](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]

 <span data-ttu-id="3c55d-188">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği doğrudan uygulama pencerenizde barındıryükleyemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="3c55d-189">Bunun yerine, önce <xref:System.Windows.Interop.HwndSource> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği kaydırmak için bir nesne oluşturun.</span><span class="sxs-lookup"><span data-stu-id="3c55d-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3c55d-190">Bu nesne temelde bir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği barındırmak için tasarlanan bir penceredir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3c55d-191">Uygulamayı, uygulamanızın <xref:System.Windows.Interop.HwndSource> bir parçası olan bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] pencerenin alt öğesi olarak oluşturarak ana pencerede barındırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="3c55d-192">Oluşturucu <xref:System.Windows.Interop.HwndSource> parametreleri, bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] alt pencere oluştururken CreateWindow 'a geçirdiğiniz bilgilerin çoğunu içerir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>

 <span data-ttu-id="3c55d-193">Bir sonraki adımda [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik nesnesinin bir örneğini oluşturun.</span><span class="sxs-lookup"><span data-stu-id="3c55d-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="3c55d-194">Bu durumda [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] , içerik,/clikullanılarak `WPFPage` C++ayrı bir sınıf olarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using C++/CLI.</span></span> <span data-ttu-id="3c55d-195">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Ayrıca[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]içeriğini de uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="3c55d-196">Ancak bunu yapmak için ayrı bir proje ayarlamanız ve [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği bir dll olarak oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a DLL.</span></span> <span data-ttu-id="3c55d-197">Projenize bu DLL 'ye bir başvuru ekleyebilir ve bu başvuruyu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik örneği oluşturmak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-197">You can add a reference to that DLL to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

 <span data-ttu-id="3c55d-198">İçeriğine bir başvuru [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] atayarak<xref:System.Windows.Interop.HwndSource.RootVisual%2A> ,<xref:System.Windows.Interop.HwndSource>içeriği alt pencerenizde görüntüleyin.</span><span class="sxs-lookup"><span data-stu-id="3c55d-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>

 <span data-ttu-id="3c55d-199">Sonraki kod satırı, `WPFButtonClicked` [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik `OnButtonClicked` olayına bir olay işleyicisi ekler.</span><span class="sxs-lookup"><span data-stu-id="3c55d-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="3c55d-200">Bu işleyici Kullanıcı **Tamam** veya **iptal** düğmesine tıkladığında çağrılır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="3c55d-201">Bu olay işleyicisi hakkında daha fazla bilgi için bkz. [communicating_with_the_WPF Content](#communicating_with_the_page) .</span><span class="sxs-lookup"><span data-stu-id="3c55d-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>

 <span data-ttu-id="3c55d-202">Gösterilen kodun son satırı, <xref:System.Windows.Interop.HwndSource> nesnesiyle ilişkili pencere tanıtıcısını (hwnd) döndürür.</span><span class="sxs-lookup"><span data-stu-id="3c55d-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="3c55d-203">Bu tanıtıcıyı kodınızdan [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] , barındırılan pencereye ileti göndermek için kullanabilirsiniz, ancak örnek bunu yapmaz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="3c55d-204"><xref:System.Windows.Interop.HwndSource> Nesnesi bir iletiyi her aldığında bir olay oluşturur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="3c55d-205">İletileri işlemek için, bir ileti işleyicisi <xref:System.Windows.Interop.HwndSource.AddHook%2A> iliştirmek ve sonra bu işleyicide iletileri işlemek üzere yöntemini çağırın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>

<a name="holding_a_reference"></a>
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="3c55d-206">WPF Içeriğine başvuru tutma</span><span class="sxs-lookup"><span data-stu-id="3c55d-206">Holding a Reference to the WPF Content</span></span>
 <span data-ttu-id="3c55d-207">Birçok uygulama için, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerikle daha sonra iletişim kurmak isteyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="3c55d-208">Örneğin, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik özelliklerini değiştirmek veya belki de <xref:System.Windows.Interop.HwndSource> nesne farklı [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik barındırmak isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3c55d-209">Bunu yapmak için, <xref:System.Windows.Interop.HwndSource> nesne [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] veya içeriğe bir başvuru gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3c55d-210">Nesne ve ilişkili [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği, pencere tanıtıcısını yok edinceye kadar bellekte kalır. <xref:System.Windows.Interop.HwndSource></span><span class="sxs-lookup"><span data-stu-id="3c55d-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="3c55d-211">Ancak, <xref:System.Windows.Interop.HwndSource> nesnesine atadığınız değişken, pencere yordamından döndükten hemen sonra kapsam dışına çıkar.</span><span class="sxs-lookup"><span data-stu-id="3c55d-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="3c55d-212">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Uygulamalarda bu sorunu işlemenin normal yöntemi, statik veya genel bir değişken kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="3c55d-213">Ne yazık ki, bu tür değişkenlere yönetilen bir nesne atayamazsınız.</span><span class="sxs-lookup"><span data-stu-id="3c55d-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="3c55d-214"><xref:System.Windows.Interop.HwndSource> Nesneyle ilişkili pencere tanıtıcısını genel veya statik bir değişkene atayabilir, ancak bu, söz konusu tikan nesnenin kendisi için erişim sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>

 <span data-ttu-id="3c55d-215">Bu soruna en basit çözüm, erişmeniz gereken herhangi bir yönetilen nesne için başvuruları tutmak üzere statik alanlar kümesi içeren bir yönetilen sınıf uygulamaktır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="3c55d-216">Örnek, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik başvurusunu `WPFPageHost` tutmak için sınıfını ve daha sonra Kullanıcı tarafından değiştirilebilecek bir dizi özelliğin başlangıç değerlerini kullanır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="3c55d-217">Bu, üst bilgide tanımlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-217">This is defined in the header.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageHost](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]

 <span data-ttu-id="3c55d-218">`GetHwnd` İşlevin ikinci bölümü, daha sonra kullanılmak üzere bu alanlara değerler atar, ancak `myPage` hala kapsamdadır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>

<a name="communicating_with_the_page"></a>
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="3c55d-219">WPF Içeriğiyle iletişim kurma</span><span class="sxs-lookup"><span data-stu-id="3c55d-219">Communicating with the WPF Content</span></span>
 <span data-ttu-id="3c55d-220">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerikle iki tür iletişim vardır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3c55d-221">Kullanıcı **Tamam** veya **iptal** düğmelerine tıkladığında [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uygulama içerikten bilgi alır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="3c55d-222">Uygulamanın arka plan rengi veya [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] varsayılan yazı tipi boyutu gibi çeşitli [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik özelliklerini değiştirmesine izin veren bir de vardır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>

 <span data-ttu-id="3c55d-223">Yukarıda belirtildiği gibi, Kullanıcı herhangi bir düğmeye [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tıkladığında içerik bir `OnButtonClicked` olay oluşturur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="3c55d-224">Uygulama bu bildirimleri almak için bu olaya bir işleyici ekler.</span><span class="sxs-lookup"><span data-stu-id="3c55d-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="3c55d-225">**Tamam** düğmesine tıklandığı işleyici, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerikten Kullanıcı bilgilerini alır ve Statik denetimler kümesi içinde görüntüler.</span><span class="sxs-lookup"><span data-stu-id="3c55d-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]

 <span data-ttu-id="3c55d-226">İşleyici, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] `MyPageEventArgs`içerikten özel bir olay bağımsız değişkeni nesnesi alır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="3c55d-227">Nesnenin `IsOK` özelliği **Tamam** düğmesine tıklandıysa `true` ve `false` **iptal** düğmesi tıklandıysa olarak ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>

 <span data-ttu-id="3c55d-228">**Tamam** düğmesine tıklandığı işleyici kapsayıcı sınıfından [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğe bir başvuru alır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="3c55d-229">Daha sonra, ilişkili [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik özellikleri tarafından tutulan Kullanıcı bilgilerini toplar ve ana pencerede bilgileri göstermek için statik denetimleri kullanır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="3c55d-230">İçerik verileri yönetilen bir dize biçiminde olduğundan, bir [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] denetim tarafından kullanılmak üzere sıralanmalıdır. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3c55d-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="3c55d-231">**İptal** düğmesine tıklandığında, işleyici verileri statik denetimlerden temizler.</span><span class="sxs-lookup"><span data-stu-id="3c55d-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>

 <span data-ttu-id="3c55d-232">Uygulama [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , kullanıcının [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğin arka plan rengini ve yazı tipiyle ilgili birkaç özelliği değiştirmesine izin veren radyo düğmeleri kümesi sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c55d-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="3c55d-233">Aşağıdaki örnek, uygulamanın pencere yordamından (WndProc) ve arka plan rengi dahil farklı iletilerde çeşitli özellikleri ayarlayan ileti işlemenin bir alıntısıdır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="3c55d-234">Diğerleri benzerdir ve gösterilmemiştir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="3c55d-235">Ayrıntılar ve bağlam için tüm örneğe bakın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-235">See the complete sample for details and context.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]

 <span data-ttu-id="3c55d-236">Arka plan rengini ayarlamak için, ( [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] `hostedPage`) `WPFPageHost` içeriğine bir başvuru alın ve arka plan rengi özelliğini uygun renge ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="3c55d-237">Örnek üç renk seçeneği kullanır: orijinal renk, açık yeşil veya hafif Salmon.</span><span class="sxs-lookup"><span data-stu-id="3c55d-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="3c55d-238">Özgün arka plan rengi, `WPFPageHost` sınıfında statik bir alan olarak depolanır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="3c55d-239">Diğerini ayarlamak için yeni <xref:System.Windows.Media.SolidColorBrush> bir nesne oluşturur ve oluşturucuyu <xref:System.Windows.Media.Colors> nesnesinden statik renkler değeri geçirin.</span><span class="sxs-lookup"><span data-stu-id="3c55d-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>

<a name="implementing_the_wpf_page"></a>
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="3c55d-240">WPF sayfasını uygulama</span><span class="sxs-lookup"><span data-stu-id="3c55d-240">Implementing the WPF Page</span></span>
 <span data-ttu-id="3c55d-241">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği gerçek uygulamayla ilgili herhangi bir bilgi olmadan barındırabilirsiniz ve kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="3c55d-242">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik ayrı bir dll 'de paketlenmişse, herhangi bir ortak dil çalışma zamanı (CLR) dilinde oluşturulmuş olabilir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate DLL, it could have been built in any common language runtime (CLR) language.</span></span> <span data-ttu-id="3c55d-243">Örnekte kullanılan C++/CLI uygulamasına ilişkin kısa bir anlatım aşağıda verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-243">Following is a brief walkthrough of the C++/CLI implementation that is used in the sample.</span></span> <span data-ttu-id="3c55d-244">Bu bölüm aşağıdaki alt bölümleri içerir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-244">This section contains the following subsections.</span></span>

- [<span data-ttu-id="3c55d-245">Düzen</span><span class="sxs-lookup"><span data-stu-id="3c55d-245">Layout</span></span>](#page_layout)

- [<span data-ttu-id="3c55d-246">Veriler konak penceresine döndürülüyor</span><span class="sxs-lookup"><span data-stu-id="3c55d-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)

- [<span data-ttu-id="3c55d-247">WPF özelliklerini ayarlama</span><span class="sxs-lookup"><span data-stu-id="3c55d-247">Setting the WPF Properties</span></span>](#set_page_properties)

<a name="page_layout"></a>
### <a name="layout"></a><span data-ttu-id="3c55d-248">Düzen</span><span class="sxs-lookup"><span data-stu-id="3c55d-248">Layout</span></span>
 <span data-ttu-id="3c55d-249">İçerikteki öğeler, ilişkili<xref:System.Windows.Controls.Label> denetimlerle birlikte beş <xref:System.Windows.Controls.TextBox> denetimden oluşur: [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Ad, adres, şehir, eyalet ve posta.</span><span class="sxs-lookup"><span data-stu-id="3c55d-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="3c55d-250">Ayrıca, **Tamam** ve <xref:System.Windows.Controls.Button> **iptal et** olmak üzere iki denetim vardır</span><span class="sxs-lookup"><span data-stu-id="3c55d-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>

 <span data-ttu-id="3c55d-251">İçerik, `WPFPage` sınıfında uygulanır. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3c55d-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="3c55d-252">Düzen bir <xref:System.Windows.Controls.Grid> düzen öğesiyle işlenir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="3c55d-253">Sınıfı öğesinden <xref:System.Windows.Controls.Grid>devralır, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] bu, içerik kök öğesi etkin bir şekilde oluşturur.</span><span class="sxs-lookup"><span data-stu-id="3c55d-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>

 <span data-ttu-id="3c55d-254">İçerik Oluşturucu gerekli genişliği ve yüksekliği alır ve <xref:System.Windows.Controls.Grid> uygun şekilde boyutları. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3c55d-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="3c55d-255">Daha sonra temel düzeni tanımlar <xref:System.Windows.Controls.ColumnDefinition> ve <xref:System.Windows.Controls.RowDefinition> nesneler kümesi oluşturup nesneleri sırasıyla <xref:System.Windows.Controls.Grid> nesne tabanına <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> ve <xref:System.Windows.Controls.Grid.RowDefinitions%2A> koleksiyonlara ekler.</span><span class="sxs-lookup"><span data-stu-id="3c55d-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="3c55d-256">Bu, hücrelerin içeriğine göre belirlenen boyutları içeren beş satırlık ve yedi sütundan oluşan bir kılavuz tanımlar.</span><span class="sxs-lookup"><span data-stu-id="3c55d-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]

 <span data-ttu-id="3c55d-257">Sonra, Oluşturucu [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] öğelerini <xref:System.Windows.Controls.Grid>öğesine ekler.</span><span class="sxs-lookup"><span data-stu-id="3c55d-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="3c55d-258">İlk öğe, kılavuzun ilk satırına ortalanmış bir <xref:System.Windows.Controls.Label> denetim olan başlık metindir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]

 <span data-ttu-id="3c55d-259">Sonraki satır, ad <xref:System.Windows.Controls.Label> denetimini ve ilişkili <xref:System.Windows.Controls.TextBox> denetimini içerir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="3c55d-260">Her etiket/metin kutusu çifti için aynı kod kullanıldığından, bir dizi özel yönteme yerleştirilir ve beş etiket/metin kutusu çifti için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="3c55d-261">Yöntemler uygun denetimi oluşturur ve denetimleri uygun hücreye yerleştirmek için <xref:System.Windows.Controls.Grid> static <xref:System.Windows.Controls.Grid.SetColumn%2A> ve <xref:System.Windows.Controls.Grid.SetRow%2A> Methods sınıfını çağırır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="3c55d-262">Denetim oluşturulduktan sonra örnek, denetimi kılavuza eklemek <xref:System.Windows.Controls.UIElementCollection.Add%2A> <xref:System.Windows.Controls.Grid> için öğesinin <xref:System.Windows.Controls.Panel.Children%2A> özelliği üzerinde yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="3c55d-263">Kalan etiketi/TextBox çiftlerini eklemek için kod benzerdir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="3c55d-264">Ayrıntılar için örnek koda bakın.</span><span class="sxs-lookup"><span data-stu-id="3c55d-264">See the sample code for details.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]

 <span data-ttu-id="3c55d-265">İki yöntemin uygulanması aşağıdaki gibidir:</span><span class="sxs-lookup"><span data-stu-id="3c55d-265">The implementation of the two methods is as follows:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]

 <span data-ttu-id="3c55d-266">Son olarak, örnek, **Tamam** ve **iptal** düğmelerini ekler ve <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olaylarına bir olay işleyicisi ekler.</span><span class="sxs-lookup"><span data-stu-id="3c55d-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]

<a name="returning_data_to_window"></a>
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="3c55d-267">Veriler konak penceresine döndürülüyor</span><span class="sxs-lookup"><span data-stu-id="3c55d-267">Returning the Data to the Host Window</span></span>
 <span data-ttu-id="3c55d-268">Düğmeye tıklandığında, <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olayı tetiklenir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="3c55d-269">Ana bilgisayar penceresi yalnızca bu olaylara işleyicileri iliştirebilir ve doğrudan <xref:System.Windows.Controls.TextBox> denetimlerden verileri alabilir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="3c55d-270">Örnek biraz daha az bir doğrudan yaklaşım kullanır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="3c55d-271">İçeriği içinde işler <xref:System.Windows.Controls.Primitives.ButtonBase.Click> ve sonra [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğe bildirimde bulunan özel bir olay `OnButtonClicked`oluşturur. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3c55d-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="3c55d-272">Bu, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğin konağa bildirmeden önce bazı parametre doğrulaması yapmasına olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c55d-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="3c55d-273">İşleyici, <xref:System.Windows.Controls.TextBox> denetimlerden metni alır ve ana bilgisayarın bilgileri alabileceği ortak özelliklere atar.</span><span class="sxs-lookup"><span data-stu-id="3c55d-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>

 <span data-ttu-id="3c55d-274">, WPFPage. h içindeki olay bildirimi:</span><span class="sxs-lookup"><span data-stu-id="3c55d-274">The event declaration, in WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]

 <span data-ttu-id="3c55d-275">WPFPage. cpp içindeki olayişleyicisi:<xref:System.Windows.Controls.Primitives.ButtonBase.Click></span><span class="sxs-lookup"><span data-stu-id="3c55d-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]

<a name="set_page_properties"></a>
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="3c55d-276">WPF özelliklerini ayarlama</span><span class="sxs-lookup"><span data-stu-id="3c55d-276">Setting the WPF Properties</span></span>
 <span data-ttu-id="3c55d-277">Ana bilgisayar, kullanıcının çeşitli [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik özelliklerini değiştirmesine izin verir. [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]</span><span class="sxs-lookup"><span data-stu-id="3c55d-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="3c55d-278">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Taraftan, özelliklerin değiştirilmesinin bir önemi vardır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="3c55d-279">Tüm denetimlerin yazı tiplerini [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] denetleyen tek bir genel özellik olmadığından, içerik sınıfındaki uygulama biraz daha karmaşıktır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="3c55d-280">Bunun yerine, her denetim için uygun özellik, Properties ' set erişimcileri içinde değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="3c55d-281">Aşağıdaki örnek, `DefaultFontFamily` özelliği için kodu gösterir.</span><span class="sxs-lookup"><span data-stu-id="3c55d-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="3c55d-282">Özelliği ayarlamak, çeşitli denetimlerin <xref:System.Windows.Controls.Control.FontFamily%2A> özelliklerini ayarlayan özel bir yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="3c55d-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>

 <span data-ttu-id="3c55d-283">WPFPage. h öğesinden:</span><span class="sxs-lookup"><span data-stu-id="3c55d-283">From WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]

 <span data-ttu-id="3c55d-284">WPFPage. cpp öğesinden:</span><span class="sxs-lookup"><span data-stu-id="3c55d-284">From WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]

## <a name="see-also"></a><span data-ttu-id="3c55d-285">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="3c55d-285">See also</span></span>

- <xref:System.Windows.Interop.HwndSource>
- [<span data-ttu-id="3c55d-286">WPF ve Win32 Birlikte Çalışması</span><span class="sxs-lookup"><span data-stu-id="3c55d-286">WPF and Win32 Interoperation</span></span>](wpf-and-win32-interoperation.md)
