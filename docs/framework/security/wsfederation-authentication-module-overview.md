---
title: WSFederation Kimlik Doğrulaması Modülüne Genel Bakış
ms.date: 03/30/2017
ms.assetid: 02c4d5e8-f0a7-49ee-9cf5-3647578510ad
author: BrucePerlerMS
ms.openlocfilehash: eaf53a352238161ccec1b481649074d322954905
ms.sourcegitcommit: 205b9a204742e9c77256d43ac9d94c3f82909808
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 09/10/2019
ms.locfileid: "70851509"
---
# <a name="wsfederation-authentication-module-overview"></a><span data-ttu-id="bfb1a-102">WSFederation Kimlik Doğrulaması Modülüne Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="bfb1a-102">WSFederation Authentication Module Overview</span></span>
<span data-ttu-id="bfb1a-103">Windows Identity Foundation (WıF), WS-Federasyon kimlik doğrulama modülü (WS-FAD) aracılığıyla ASP.NET uygulamalarında federal kimlik doğrulaması desteği içerir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-103">Windows Identity Foundation (WIF) includes support for federated authentication in ASP.NET applications through the WS-Federated Authentication Module (WS-FAM).</span></span> <span data-ttu-id="bfb1a-104">Bu konu, federal kimlik doğrulamanın nasıl çalıştığını ve nasıl kullanılacağını anlamanıza yardımcı olur.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-104">This topic will help you understand how federated authentication works and how to use it.</span></span>  
  
### <a name="overview-of-federated-authentication"></a><span data-ttu-id="bfb1a-105">Federal kimlik doğrulamasına genel bakış</span><span class="sxs-lookup"><span data-stu-id="bfb1a-105">Overview of Federated Authentication</span></span>  
 <span data-ttu-id="bfb1a-106">Federe kimlik doğrulaması, iki etki alanı arasında bir güven ilişkisi olduğunda, bir güven etki alanındaki güvenlik belirteci hizmeti 'nin (STS) başka bir güven etki alanındaki STS 'ye kimlik doğrulaması bilgilerini sağlamasına izin verir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-106">Federated authentication allows a Security Token Service (STS) in one trust domain to provide authentication information to an STS in another trust domain when there is a trust relationship between the two domains.</span></span> <span data-ttu-id="bfb1a-107">Aşağıdaki çizimde buna bir örnek gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="bfb1a-107">An example of this is shown in the following illustration:</span></span>  
  
 ![Federal Kimlik doğrulama senaryosunu gösteren diyagram.](./media/wsfederation-authentication-module-overview/federated-authentication.gif)  
  
1. <span data-ttu-id="bfb1a-109">Fabrikam Trust etki alanındaki bir istemci, Contoso güven etki alanındaki bir bağlı olan taraf (RP) uygulamasına bir istek gönderir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-109">A client in the Fabrikam trust domain sends a request to a Relying Party (RP) application in the Contoso trust domain.</span></span>  
  
2. <span data-ttu-id="bfb1a-110">RP, istemciyi Contoso güven etki alanındaki bir STS 'ye yönlendirir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-110">The RP redirects the client to an STS in the Contoso trust domain.</span></span> <span data-ttu-id="bfb1a-111">Bu STS 'nin istemci bilgisi yok.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-111">This STS has no knowledge of the client.</span></span>  
  
3. <span data-ttu-id="bfb1a-112">Contoso STS, bu istemciyi, Contoso güven etki alanının bir güven ilişkisine sahip olduğu Fabrikam güven etki alanındaki bir STS 'ye yönlendirir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-112">The Contoso STS redirects the client to an STS in the Fabrikam trust domain, with which the Contoso trust domain has a trust relationship.</span></span>  
  
4. <span data-ttu-id="bfb1a-113">Fabrikam STS, istemcinin kimliğini doğrular ve Contoso STS 'ye bir güvenlik belirteci yayınlar.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-113">The Fabrikam STS verifies the client’s identity and issues a security token to the Contoso STS.</span></span>  
  
5. <span data-ttu-id="bfb1a-114">Contoso STS, RP tarafından kullanılabilecek kendi belirtecini oluşturmak için fabrikam belirtecini kullanır ve bunu RP 'ye gönderir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-114">The Contoso STS uses the Fabrikam token to create its own token that can be used by the RP and sends it to the RP.</span></span>  
  
6. <span data-ttu-id="bfb1a-115">RP, istemcinin taleplerini güvenlik belirtecinden ayıklar ve yetkilendirme kararı vermez.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-115">The RP extracts the client’s claims from the security token and makes an authorization decision.</span></span>  
  
### <a name="using-the-federated-authentication-module-with-aspnet"></a><span data-ttu-id="bfb1a-116">ASP.NET ile federal kimlik doğrulama modülünü kullanma</span><span class="sxs-lookup"><span data-stu-id="bfb1a-116">Using the Federated Authentication Module with ASP.NET</span></span>  
 <span data-ttu-id="bfb1a-117"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule>(WS-Fae), bir ASP.NET uygulamasına federe kimlik doğrulaması eklemenize olanak tanıyan bir HTTP modülüdür.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-117"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule> (WS-FAM) is an HTTP module that lets you add federated authentication to an ASP.NET application.</span></span> <span data-ttu-id="bfb1a-118">Federal kimlik doğrulaması, kimlik doğrulama mantığının STS tarafından işlenmesini sağlar ve iş mantığı yazmaya odaklanmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-118">Federated authentication lets authentication logic be handled by the STS and lets you focus on writing business logic.</span></span>  
  
 <span data-ttu-id="bfb1a-119">WS-FAD 'yi, kimliği doğrulanmamış isteklerin yeniden yönlendirilmesi gereken STS 'yi belirtecek şekilde yapılandırırsınız.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-119">You configure the WS-FAM to specify the STS to which non-authenticated requests should be redirected.</span></span> <span data-ttu-id="bfb1a-120">WıF, bir kullanıcının kimlik doğrulamasını iki şekilde yapmanızı sağlar:</span><span class="sxs-lookup"><span data-stu-id="bfb1a-120">WIF lets you authenticate a user in two ways:</span></span>  
  
1. <span data-ttu-id="bfb1a-121">Pasif yeniden yönlendirme: Kimliği doğrulanmamış bir Kullanıcı, korumalı bir kaynağa erişmeye çalıştığında ve yalnızca bir oturum açma sayfası gerekmeden bunları bir STS 'ye yönlendirmek istediğinizde, bu doğru yaklaşımdır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-121">Passive redirect: When an unauthenticated user tries to access a protected resource, and you want to simply redirect them to an STS without requiring a login page, then this is the right approach.</span></span> <span data-ttu-id="bfb1a-122">STS kullanıcının kimliğini doğrular ve bu kullanıcı için uygun talepleri içeren bir güvenlik belirteci yayınlar.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-122">The STS verifies the user’s identity, and issues a security token that contains the appropriate claims for that user.</span></span> <span data-ttu-id="bfb1a-123">Bu seçenek, HTTP modülleri ardışık düzeninde WS-Fae eklenmesini gerektirir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-123">This option requires the WS-FAM to be added in the HTTP Modules pipeline.</span></span> <span data-ttu-id="bfb1a-124">Visual Studio 2012 için kimlik ve erişim aracı 'nı kullanarak, uygulamanızın yapılandırma dosyasını WS-FAD kullanacak şekilde değiştirebilir ve bir STS ile federasyona bağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-124">You can use the Identity and Access Tool for Visual Studio 2012 to modify your application’s configuration file to use the WS-FAM and to federate with an STS.</span></span> <span data-ttu-id="bfb1a-125">Daha fazla bilgi için bkz. [Visual Studio Için kimlik ve erişim aracı 2012](../../../docs/framework/security/identity-and-access-tool-for-vs.md).</span><span class="sxs-lookup"><span data-stu-id="bfb1a-125">For more information, see [Identity and Access Tool for Visual Studio 2012](../../../docs/framework/security/identity-and-access-tool-for-vs.md).</span></span>  
  
2. <span data-ttu-id="bfb1a-126">RP uygulamanızdaki bir oturum <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SignIn%2A?displayProperty=nameWithType> açma sayfası için <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectToIdentityProvider%2A> arka plan kodundaki yöntemi veya yöntemi çağırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-126">You can call the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SignIn%2A?displayProperty=nameWithType> method or the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectToIdentityProvider%2A> method from the code-behind for a sign-in page in your RP application.</span></span>  
  
 <span data-ttu-id="bfb1a-127">Pasif yeniden yönlendirmeye yönelik tüm iletişimler istemciden yanıt/yeniden yönlendirme (genellikle bir tarayıcı) yoluyla gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-127">In passive redirect, all communication is performed through response/redirect from the client (typically a browser).</span></span> <span data-ttu-id="bfb1a-128">WS-Fae 'yi uygulamanızın HTTP işlem hattına ekleyerek kimliği doğrulanmamış kullanıcı isteklerini izler ve belirttiğiniz STS 'ye Kullanıcı yeniden yönlendirir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-128">You can add the WS-FAM to your application’s HTTP pipeline, where it watches for unauthenticated user requests and redirects users to the STS you specify.</span></span>  
  
 <span data-ttu-id="bfb1a-129">WS-FAM Ayrıca bir ASP.NET uygulamasında işlevlerini özelleştirmenizi sağlayan çeşitli olaylar oluşturur.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-129">The WS-FAM also raises several events that let you customize its functionality in an ASP.NET application.</span></span>  
  
### <a name="how-the-ws-fam-works"></a><span data-ttu-id="bfb1a-130">WS-fab nasıl çalıştığı</span><span class="sxs-lookup"><span data-stu-id="bfb1a-130">How the WS-FAM Works</span></span>  
 <span data-ttu-id="bfb1a-131">WS-FAD, <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> sınıfında uygulanır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-131">The WS-FAM is implemented in the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> class.</span></span> <span data-ttu-id="bfb1a-132">Genellikle, WS-Fae 'yi ASP.NET RP uygulamanızın HTTP işlem hattına eklersiniz.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-132">Typically, you add the WS-FAM to the HTTP pipeline of your ASP.NET RP application.</span></span> <span data-ttu-id="bfb1a-133">Kimliği doğrulanmamış bir kullanıcı korumalı bir kaynağa erişmeyi denediğinde, RP bir "401 yetkilendirme reddedildi" HTTP yanıtı döndürür.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-133">When an unauthenticated user tries to access a protected resource, the RP returns a "401 authorization denied" HTTP response.</span></span> <span data-ttu-id="bfb1a-134">WS-FAD bu yanıtı, istemcinin almasına izin vermek yerine karşılar, ardından kullanıcıyı belirtilen STS 'ye yeniden yönlendirir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-134">The WS-FAM intercepts this response instead of allowing the client to receive it, then it redirects the user to the specified STS.</span></span> <span data-ttu-id="bfb1a-135">STS, WS-FAD 'nin yeniden aldığı bir güvenlik belirteci verir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-135">The STS issues a security token, which the WS-FAM again intercepts.</span></span> <span data-ttu-id="bfb1a-136">WS-FAD, kimliği doğrulanmış kullanıcı <xref:System.Security.Claims.ClaimsPrincipal> için, normal .NET Framework yetkilendirme mekanizmalarının çalışmasını sağlayan bir örneğini oluşturmak için belirtecini kullanır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-136">The WS-FAM uses the token to create an instance of <xref:System.Security.Claims.ClaimsPrincipal> for the authenticated user, which enables regular .NET Framework authorization mechanisms to function.</span></span>  
  
 <span data-ttu-id="bfb1a-137">HTTP durum bilgisiz olduğundan, Kullanıcı başka bir korumalı kaynağa erişmeyi her denediğinde bu işlemin tamamını tekrarlamadan kaçınmak için bir yol gerekir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-137">Because HTTP is stateless, we need a way to avoid repeating this whole process every time that the user tries to access another protected resource.</span></span> <span data-ttu-id="bfb1a-138">Burada <xref:System.IdentityModel.Services.SessionAuthenticationModule> geldiği yerdir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-138">This is where the <xref:System.IdentityModel.Services.SessionAuthenticationModule> comes in.</span></span> <span data-ttu-id="bfb1a-139">STS Kullanıcı için bir güvenlik belirteci oluşturduğunda, <xref:System.IdentityModel.Services.SessionAuthenticationModule> Kullanıcı için bir oturum güvenlik belirteci de oluşturur ve bir tanımlama bilgisine koyar.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-139">When the STS issues a security token for the user, <xref:System.IdentityModel.Services.SessionAuthenticationModule> also creates a session security token for the user and puts it in a cookie.</span></span> <span data-ttu-id="bfb1a-140">Sonraki isteklerde <xref:System.IdentityModel.Services.SessionAuthenticationModule> , bu tanımlama bilgisini karşılar ve <xref:System.Security.Claims.ClaimsPrincipal>Kullanıcı tarafından yeniden oluşturmak için kullanır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-140">On subsequent requests, the <xref:System.IdentityModel.Services.SessionAuthenticationModule> intercepts this cookie and uses it to reconstruct the user’s <xref:System.Security.Claims.ClaimsPrincipal>.</span></span>  
  
 <span data-ttu-id="bfb1a-141">Aşağıdaki diyagramda, pasif yeniden yönlendirme kasasının genel bilgi akışı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-141">The following diagram shows the overall flow of information in the passive redirect case.</span></span> <span data-ttu-id="bfb1a-142">İstek bir oturum açma sayfası olmadan kimlik bilgileri oluşturmak için STS aracılığıyla otomatik olarak yönlendirilir:</span><span class="sxs-lookup"><span data-stu-id="bfb1a-142">The request is automatically redirected via the STS to establish credentials without a login page:</span></span>  
  
 ![Pasif yeniden yönlendirme ile oturum açma gösteren diyagram.](./media/wsfederation-authentication-module-overview/sign-in-using-passive-redirect.gif)  
  
 <span data-ttu-id="bfb1a-144">Aşağıdaki diyagramda, Kullanıcı STS 'ye kimlik doğrulaması yapıldığında ne olacağı ve bunların güvenlik belirteçleri tarafından <xref:System.IdentityModel.Services.WSFederationAuthenticationModule>işlendiği konusunda daha fazla ayrıntı gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="bfb1a-144">The following diagram shows more detail on what happens when the user has authenticated to the STS and their security tokens are processed by the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule>:</span></span>  
  
 <span data-ttu-id="bfb1a-145">![Pasif yönlendirme ile belirteç Işleme zamanlaması](../../../docs/framework/security/media/signinusingpassiveredirect-tokenprocessing.gif "SignInUsingPassiveRedirect_TokenProcessing")</span><span class="sxs-lookup"><span data-stu-id="bfb1a-145">![Timing for token processing with passive redirect](../../../docs/framework/security/media/signinusingpassiveredirect-tokenprocessing.gif "SignInUsingPassiveRedirect_TokenProcessing")</span></span>  
  
 <span data-ttu-id="bfb1a-146">Aşağıdaki diyagramda, kullanıcının güvenlik belirteçleri tanımlama bilgilerine serileştirildiğinde ve tarafından yakalanarak <xref:System.IdentityModel.Services.SessionAuthenticationModule>ne olacağı hakkında daha fazla ayrıntı gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="bfb1a-146">The following diagram shows more detail on what happens when the user’s security tokens have been serialized into cookies and are intercepted by the <xref:System.IdentityModel.Services.SessionAuthenticationModule>:</span></span>  
  
 <span data-ttu-id="bfb1a-147">![Denetimleri kullanarak oturum açma&#45;gösteren Sam zamanlama diyagramı](../../../docs/framework/security/media/signinusingconrols-sam.gif "SignInUsingConrols_SAM")</span><span class="sxs-lookup"><span data-stu-id="bfb1a-147">![SAM timing diagram showing sign&#45;in using controls](../../../docs/framework/security/media/signinusingconrols-sam.gif "SignInUsingConrols_SAM")</span></span>  
  
### <a name="events"></a><span data-ttu-id="bfb1a-148">Olaylar</span><span class="sxs-lookup"><span data-stu-id="bfb1a-148">Events</span></span>  
 <span data-ttu-id="bfb1a-149"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule>, ve üst <xref:System.IdentityModel.Services.HttpModuleBase>sınıfları, bir http isteğinin işlenmesi için çeşitli aşamalarda olay yükseltir. <xref:System.IdentityModel.Services.SessionAuthenticationModule></span><span class="sxs-lookup"><span data-stu-id="bfb1a-149"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule>, <xref:System.IdentityModel.Services.SessionAuthenticationModule>, and their parent class, <xref:System.IdentityModel.Services.HttpModuleBase>, raise events at various stages of processing of an HTTP request.</span></span> <span data-ttu-id="bfb1a-150">Bu olayları `global.asax` ASP.net uygulamanızın dosyasında işleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-150">You can handle these events in the `global.asax` file of your ASP.NET application.</span></span>  
  
- <span data-ttu-id="bfb1a-151">ASP.NET altyapısı modülü başlatmak için modülün <xref:System.IdentityModel.Services.HttpModuleBase.Init%2A> yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-151">The ASP.NET infrastructure invokes the module’s <xref:System.IdentityModel.Services.HttpModuleBase.Init%2A> method to initialize the module.</span></span>  
  
- <span data-ttu-id="bfb1a-152">Olay, ASP.NET altyapısı, uygulamanın sınıfından türetilen <xref:System.IdentityModel.Services.HttpModuleBase>modüllerden <xref:System.IdentityModel.Services.HttpModuleBase.Init%2A> birinin ilk kez çağırışında tetiklenir. <xref:System.IdentityModel.Services.FederatedAuthentication.FederationConfigurationCreated?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="bfb1a-152">The <xref:System.IdentityModel.Services.FederatedAuthentication.FederationConfigurationCreated?displayProperty=nameWithType> event is raised when the ASP.NET infrastructure invokes the <xref:System.IdentityModel.Services.HttpModuleBase.Init%2A> method for the first time on one of the application’s modules that derive from <xref:System.IdentityModel.Services.HttpModuleBase>.</span></span> <span data-ttu-id="bfb1a-153">Bu yöntem, yapılandırmanın Web <xref:System.IdentityModel.Services.FederatedAuthentication.FederationConfiguration%2A?displayProperty=nameWithType> . config dosyasından yüklenmesine neden olan static özelliğine erişir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-153">This method accesses the static <xref:System.IdentityModel.Services.FederatedAuthentication.FederationConfiguration%2A?displayProperty=nameWithType> property, which causes configuration to be loaded from the Web.config file.</span></span> <span data-ttu-id="bfb1a-154">Bu olay yalnızca bu özelliğe ilk kez erişildiğinde oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-154">This event is only raised the first time this property is accessed.</span></span> <span data-ttu-id="bfb1a-155">Yapılandırmadan başlatılan <xref:System.IdentityModel.Services.Configuration.FederationConfigurationCreatedEventArgs.FederationConfiguration%2A?displayProperty=nameWithType> nesneye bir olay işleyicisindeki özelliği aracılığıyla erişilebilir. <xref:System.IdentityModel.Services.Configuration.FederationConfiguration></span><span class="sxs-lookup"><span data-stu-id="bfb1a-155">The <xref:System.IdentityModel.Services.Configuration.FederationConfiguration> object that is initialized from configuration can be accessed through the <xref:System.IdentityModel.Services.Configuration.FederationConfigurationCreatedEventArgs.FederationConfiguration%2A?displayProperty=nameWithType> property in an event handler.</span></span> <span data-ttu-id="bfb1a-156">Bu olayı, herhangi bir modüle uygulanmadan önce yapılandırmayı değiştirmek için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-156">You can use this event to modify the configuration before it is applied to any modules.</span></span> <span data-ttu-id="bfb1a-157">Application_Start yönteminde bu olay için bir işleyici ekleyebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="bfb1a-157">You can add a handler for this event in the Application_Start method:</span></span>  
  
    ```csharp
    void Application_Start(object sender, EventArgs e)  
    {  
        FederatedAuthentication.FederationConfigurationCreated += new EventHandler<FederationConfigurationCreatedEventArgs>(FederatedAuthentication_FederationConfigurationCreated);  
    }  
    ```  
  
     <span data-ttu-id="bfb1a-158">Her modül <xref:System.IdentityModel.Services.HttpModuleBase.InitializeModule%2A?displayProperty=nameWithType> ve <xref:System.IdentityModel.Services.HttpModuleBase.InitializePropertiesFromConfiguration%2A?displayProperty=nameWithType> soyut yöntemleri geçersiz kılar.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-158">Each module overrides the <xref:System.IdentityModel.Services.HttpModuleBase.InitializeModule%2A?displayProperty=nameWithType> and <xref:System.IdentityModel.Services.HttpModuleBase.InitializePropertiesFromConfiguration%2A?displayProperty=nameWithType> abstract methods.</span></span> <span data-ttu-id="bfb1a-159">Bu yöntemlerin ilki, modülün ilgisini çeken ASP.NET işlem hattı olayları için işleyiciler ekler.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-159">The first of these methods adds handlers for ASP.NET pipeline events that are of interest to the module.</span></span> <span data-ttu-id="bfb1a-160">Çoğu durumda, modülün varsayılan uygulama yeterli olacaktır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-160">In most cases the module’s default implementation will suffice.</span></span> <span data-ttu-id="bfb1a-161">Bu yöntemlerin İkincisi, modülünün özelliklerini <xref:System.IdentityModel.Services.HttpModuleBase.FederationConfiguration%2A?displayProperty=nameWithType> özelliğinden başlatır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-161">The second of these methods initializes the module’s properties from its <xref:System.IdentityModel.Services.HttpModuleBase.FederationConfiguration%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="bfb1a-162">(Bu, daha önce yüklenen yapılandırmanın bir kopyasıdır.) <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> Veya<xref:System.IdentityModel.Services.SessionAuthenticationModule>' den türettiğiniz sınıflarda yapılandırmadan yeni özelliklerin başlatılmasını desteklemek istiyorsanız bu ikinci yöntemi geçersiz kılmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-162">(This is a copy of the configuration that was loaded previously.) You may need to override this second method if you want to support the initialization of new properties from configuration in classes that you derive from <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> or <xref:System.IdentityModel.Services.SessionAuthenticationModule>.</span></span> <span data-ttu-id="bfb1a-163">Bu gibi durumlarda, eklenen yapılandırma özelliklerini desteklemek için uygun yapılandırma nesnelerinden de türetmeniz gerekir; Örneğin,, veya <xref:System.IdentityModel.Configuration.IdentityConfiguration> <xref:System.IdentityModel.Services.Configuration.FederationConfiguration>' <xref:System.IdentityModel.Services.Configuration.WsFederationConfiguration>den.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-163">In such cases you would also need to derive from the appropriate configuration objects to support the added configuration properties; for example, from <xref:System.IdentityModel.Configuration.IdentityConfiguration>, <xref:System.IdentityModel.Services.Configuration.WsFederationConfiguration>, or <xref:System.IdentityModel.Services.Configuration.FederationConfiguration>.</span></span>  
  
- <span data-ttu-id="bfb1a-164">WS-Fab, STS tarafından <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SecurityTokenReceived> verilen bir güvenlik belirtecini keserken olayı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-164">The WS-FAM raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SecurityTokenReceived> event when it intercepts a security token that has been issued by the STS.</span></span>  
  
- <span data-ttu-id="bfb1a-165">WS-Fab, belirteci doğruladıktan <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SecurityTokenValidated> sonra olayı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-165">The WS-FAM raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SecurityTokenValidated> event after it has validated the token.</span></span>  
  
- <span data-ttu-id="bfb1a-166">, <xref:System.IdentityModel.Services.SessionAuthenticationModule>Kullanıcı için bir oturum güvenlik belirteci oluşturduğunda olayınıoluşturur.<xref:System.IdentityModel.Services.SessionAuthenticationModule.SessionSecurityTokenCreated></span><span class="sxs-lookup"><span data-stu-id="bfb1a-166">The <xref:System.IdentityModel.Services.SessionAuthenticationModule> raises the <xref:System.IdentityModel.Services.SessionAuthenticationModule.SessionSecurityTokenCreated> event when it creates a session security token for the user.</span></span>  
  
- <span data-ttu-id="bfb1a-167">, <xref:System.IdentityModel.Services.SessionAuthenticationModule> Oturum güvenlik <xref:System.IdentityModel.Services.SessionAuthenticationModule.SessionSecurityTokenReceived> belirtecini içeren tanımlama bilgisiyle sonraki istekleri algıladığında olayı başlatır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-167">The <xref:System.IdentityModel.Services.SessionAuthenticationModule> raises the <xref:System.IdentityModel.Services.SessionAuthenticationModule.SessionSecurityTokenReceived> event when it intercepts subsequent requests with the cookie that contains the session security token.</span></span>  
  
- <span data-ttu-id="bfb1a-168">WS-FAD, kullanıcıyı veren kullanıcıya yönlendirdikten sonra <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectingToIdentityProvider> olayı başlatır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-168">Before the WS-FAM redirects the user to the issuer, it raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectingToIdentityProvider> event.</span></span> <span data-ttu-id="bfb1a-169">WS-Federation oturum açma isteği, olayın <xref:System.IdentityModel.Services.RedirectingToIdentityProviderEventArgs.SignInRequestMessage%2A> <xref:System.IdentityModel.Services.RedirectingToIdentityProviderEventArgs> geçirildiği özelliği aracılığıyla kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-169">The WS-Federation sign-in request is available through the <xref:System.IdentityModel.Services.RedirectingToIdentityProviderEventArgs.SignInRequestMessage%2A> property of the <xref:System.IdentityModel.Services.RedirectingToIdentityProviderEventArgs> passed in the event.</span></span> <span data-ttu-id="bfb1a-170">Sertifikayı verene göndermeden önce isteği değiştirmeyi tercih edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-170">You may choose to modify the request before sending this out to the issuer.</span></span>  
  
- <span data-ttu-id="bfb1a-171">WS-Fab, tanımlama bilgisi <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SignedIn> başarıyla yazıldığında ve Kullanıcı oturum açınca olayı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-171">The WS-FAM raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SignedIn> event when the cookie is successfully written and the user is signed in.</span></span>  
  
- <span data-ttu-id="bfb1a-172">WS-Fab, oturum her <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SigningOut> bir kullanıcı için kapatıldığından, her oturum için bir kez olay oluşturur.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-172">The WS-FAM raises the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.SigningOut> event one time per session as the session is being closed down for each user.</span></span> <span data-ttu-id="bfb1a-173">Oturum, istemci tarafında kapalıysa (örneğin, oturum tanımlama bilgisini silerek) oluşturulmaz.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-173">It is not raised if the session is closed down on the client-side (for example, by deleting the session cookie).</span></span> <span data-ttu-id="bfb1a-174">Bir SSO ortamında, IP STS, her bir RP 'yi da oturumu kapatmak için isteyebilir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-174">In an SSO environment, the IP-STS can request each RP to sign out, too.</span></span> <span data-ttu-id="bfb1a-175">Bu, olarak <xref:System.IdentityModel.Services.SigningOutEventArgs.IsIPInitiated%2A> `true`ayarlanmış olan bu olayı da yükseltir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-175">This will also raise this event, with <xref:System.IdentityModel.Services.SigningOutEventArgs.IsIPInitiated%2A> set to `true`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="bfb1a-176">Veya <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType> <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> tarafından oluşturulanherhangibirolaysırasındaözelliğinikullanmamalısınız.<xref:System.IdentityModel.Services.SessionAuthenticationModule></span><span class="sxs-lookup"><span data-stu-id="bfb1a-176">You should not use the <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType> property during any event raised by <xref:System.IdentityModel.Services.WSFederationAuthenticationModule> or <xref:System.IdentityModel.Services.SessionAuthenticationModule>.</span></span> <span data-ttu-id="bfb1a-177">Bunun nedeni <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType> , kimlik doğrulama işlemi sırasında olaylar oluşturulduğunda, kimlik doğrulama işleminden sonra ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-177">This is because <xref:System.Threading.Thread.CurrentPrincipal%2A?displayProperty=nameWithType> is set after the authentication process, while events are raised during the authentication process.</span></span>  
  
### <a name="configuration-of-federated-authentication"></a><span data-ttu-id="bfb1a-178">Federal kimlik doğrulaması yapılandırması</span><span class="sxs-lookup"><span data-stu-id="bfb1a-178">Configuration of Federated Authentication</span></span>  
 <span data-ttu-id="bfb1a-179">WS-fak ve Sam, [ \<FederationConfiguration >](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/federationconfiguration.md) öğesi aracılığıyla yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-179">The WS-FAM and SAM are configured through the [\<federationConfiguration>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/federationconfiguration.md) element.</span></span> <span data-ttu-id="bfb1a-180"><xref:System.IdentityModel.Services.WSFederationAuthenticationModule.Issuer%2A> <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.Realm%2A> [ Wsfeder>altöğesi,WS-FADözellikleriiçinvarsayılan\<](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/wsfederation.md) değerleri yapılandırır; Örneğin, özelliği ve özelliği.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-180">The [\<wsFederation>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/wsfederation.md) child element configures default values for the WS-FAM properties; such as the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.Issuer%2A> property and the <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.Realm%2A> property.</span></span> <span data-ttu-id="bfb1a-181">(Bu değerler, bazı WS-FAı olayları için işleyiciler sağlayarak istek başına temelinde değiştirilebilir; Örneğin, <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectingToIdentityProvider>.) Sam tarafından kullanılan tanımlama bilgisi işleyicisi, tanımlayan [ \<ıehandler >](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/cookiehandler.md) alt öğesi aracılığıyla yapılandırılır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-181">(These values can be changed on a per request basis by providing handlers for some of the WS-FAM events; for example, <xref:System.IdentityModel.Services.WSFederationAuthenticationModule.RedirectingToIdentityProvider>.) The cookie handler that is used by the SAM is configured through the [\<cookieHandler>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/cookiehandler.md) child element.</span></span> <span data-ttu-id="bfb1a-182">WIF, bir <xref:System.IdentityModel.Services.ChunkedCookieHandler> sınıfta uygulanan, öbek boyutu [ \<parçalama >](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/chunkedcookiehandler.md) öğesi aracılığıyla ayarlanmış bir varsayılan tanımlama bilgisi işleyicisi sağlar.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-182">WIF provides a default cookie handler implemented in the <xref:System.IdentityModel.Services.ChunkedCookieHandler> class that can have its chunk size set through the [\<chunkedCookieHandler>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/chunkedcookiehandler.md) element.</span></span> <span data-ttu-id="bfb1a-183">Öğesi, <xref:System.IdentityModel.Configuration.IdentityConfiguration>uygulamada kullanılan ve<xref:System.Security.Claims.ClaimsAuthorizationManager>gibidiğer WIF bileşenleri için yapılandırma sağlayan bir öğesine başvurur. <xref:System.Security.Claims.ClaimsAuthenticationManager> `<federationConfiguration>`</span><span class="sxs-lookup"><span data-stu-id="bfb1a-183">The `<federationConfiguration>` element references an <xref:System.IdentityModel.Configuration.IdentityConfiguration>, which provides configuration for other WIF components used in the application, such as the <xref:System.Security.Claims.ClaimsAuthenticationManager> and the <xref:System.Security.Claims.ClaimsAuthorizationManager>.</span></span> <span data-ttu-id="bfb1a-184">`identityConfigurationName` Öğe özniteliğinde [ \<](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md) adlandırılmış bir IdentityConfiguration > öğesi belirtilerek kimlik yapılandırmasına açıkça başvurulabilir. `<federationConfiguration>`</span><span class="sxs-lookup"><span data-stu-id="bfb1a-184">The identity configuration may be referenced explicitly by specifying a named [\<identityConfiguration>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/identityconfiguration.md) element in the `identityConfigurationName` attribute of the `<federationConfiguration>` element.</span></span> <span data-ttu-id="bfb1a-185">Kimlik yapılandırmasına açıkça başvurulmuyorsa, varsayılan kimlik yapılandırması kullanılacaktır.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-185">If the identity configuration is not referenced explicitly, the default identity configuration will be used.</span></span>  
  
 <span data-ttu-id="bfb1a-186">Aşağıdaki XML, bir ASP.NET bağlı olan taraf (RP) uygulamasının yapılandırmasını gösterir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-186">The following XML shows a configuration of an ASP.NET relying party (RP) application.</span></span> <span data-ttu-id="bfb1a-187"><xref:System.IdentityModel.Configuration.SystemIdentityModelSection> Ve yapılandırma<xref:System.IdentityModel.Services.Configuration.SystemIdentityModelServicesSection>bölümleriöğesialtınaeklenir `<configSections>` .</span><span class="sxs-lookup"><span data-stu-id="bfb1a-187">The <xref:System.IdentityModel.Configuration.SystemIdentityModelSection> and <xref:System.IdentityModel.Services.Configuration.SystemIdentityModelServicesSection> configuration sections are added under the `<configSections>` element.</span></span> <span data-ttu-id="bfb1a-188">Sam ve WS-FAD, `<system.webServer>` `<modules>` öğesinin altındaki / http modüllerine eklenir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-188">The SAM and WS-FAM are added to the HTTP Modules under the `<system.webServer>`/`<modules>` element.</span></span> <span data-ttu-id="bfb1a-189">Son olarak, `<system.identityModel>` WIF bileşenleri `<identityConfiguration>` ve / `<system.identityModel.services>` öğelerialtındayapılandırılır`<federationConfiguration>` . /</span><span class="sxs-lookup"><span data-stu-id="bfb1a-189">Finally the WIF components are configured under the `<system.identityModel>`/`<identityConfiguration>` and `<system.identityModel.services>`/`<federationConfiguration>` elements.</span></span> <span data-ttu-id="bfb1a-190">Bu yapılandırma, varsayılan tanımlama bilgisi işleyicisidir ve `<cookieHandler>` öğesinde belirtilen bir tanımlama bilgisi işleyici türü olmadığından, öbekli tanımlama bilgisi işleyicisini belirtir.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-190">This configuration specifies the chunked cookie handler as it is the default cookie handler and there is not a cookie handler type specified in the `<cookieHandler>` element.</span></span>  
  
> [!WARNING]
> <span data-ttu-id="bfb1a-191">Aşağıdaki örnekte `requireHttps` , hem `<wsFederation>` öğesinin `requireSsl` özniteliği hem de `<cookieHandler>` öğesi `false`özniteliği.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-191">In the following example, both the `requireHttps` attribute of the `<wsFederation>` element and the `requireSsl` attribute of the `<cookieHandler>` element are `false`.</span></span> <span data-ttu-id="bfb1a-192">Bu, olası bir güvenlik tehdidi sunar.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-192">This presents a potential security threat.</span></span> <span data-ttu-id="bfb1a-193">Üretimde, bu değerlerin her ikisi de ayarlanmalıdır `true`.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-193">In production, both these values should be set `true`.</span></span>  
  
```xml  
<configuration>  
  <configSections>  
    <section name="system.identityModel" type="System.IdentityModel.Configuration.SystemIdentityModelSection, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />  
    <section name="system.identityModel.services" type="System.IdentityModel.Services.Configuration.SystemIdentityModelServicesSection, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />  
  </configSections>  
  
  ...  
  
  <system.webServer>  
    <modules>  
      <add name="WSFederationAuthenticationModule" type="System.IdentityModel.Services.WSFederationAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" preCondition="managedHandler" />  
      <add name="SessionAuthenticationModule" type="System.IdentityModel.Services.SessionAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" preCondition="managedHandler" />  
    </modules>  
  </system.webServer>  
  
  <system.identityModel>  
    <identityConfiguration>  
      <audienceUris>  
        <add value="http://localhost:50969/" />  
      </audienceUris>  
      <certificateValidation certificateValidationMode="None" />  
      <issuerNameRegistry type="System.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, System.IdentityModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">  
        <trustedIssuers>  
          <add thumbprint="9B74CB2F320F7AAFC156E1252270B1DC01EF40D0" name="LocalSTS" />  
        </trustedIssuers>  
      </issuerNameRegistry>  
    </identityConfiguration>  
  </system.identityModel>  
  <system.identityModel.services>  
    <federationConfiguration>  
      <wsFederation passiveRedirectEnabled="true" issuer="http://localhost:15839/wsFederationSTS/Issue" realm="http://localhost:50969/" reply="http://localhost:50969/" requireHttps="false" />  
      <cookieHandler requireSsl="false" />  
    </federationConfiguration>  
  </system.identityModel.services>  
</configuration>  
```  
  
## <a name="see-also"></a><span data-ttu-id="bfb1a-194">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="bfb1a-194">See also</span></span>

- <xref:System.IdentityModel.Services.SessionAuthenticationModule>
- <xref:System.IdentityModel.Services.WSFederationAuthenticationModule>
- [<span data-ttu-id="bfb1a-195">\<federationConfiguration ></span><span class="sxs-lookup"><span data-stu-id="bfb1a-195">\<federationConfiguration></span></span>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/federationconfiguration.md)
